# ダッシュボードRPGビジュアル要件（仮）

## 1. ゴール / 非ゴール
- **ゴール**: ドラゴンクエスト風のUI表現を備えたダッシュボード画面を設計し、進捗管理UIにクラシックRPGの雰囲気を付与する。
- **非ゴール (MVP)**:
  - バトルシステムやシナリオ進行などロジック面の拡張
  - サウンド実装（BGM/SEの具体ファイルは別途検討）
  - リアルタイム同期の仕様変更（既存Realtime要件を流用）

## 2. ペルソナと体験シナリオ
- **利用者像**: タスク管理の習慣をRPGの世界観で楽しみたい個人開発者。
- **利用状況**: PCブラウザでソロ開発タスクを管理しつつ、やる気を上げたいときにRPGダッシュボードへ切り替える。
- **体験価値**: 直感的なステータス把握、クラシックRPGを彷彿とさせる演出、タスク完了時の達成感増幅。

## 3. 画面構成（ワイヤーフレーム概要）
```
┌──────────────────────────────────┐
│ [メインマップ] 最大全画面。背景は草原タイル＋パララックス雲。│
│                                                              │
│                                                              │
│                                                              │
│                                                              │
│                                                              │
│                                                              │
├───────────────┬──────────────────────────────┤
│ [ステータス枠]    │ [コマンドウィンドウ]                        │
│   アバター名       │ タスク / ポモ / レコードの3タブ               │
│   完了数・集中ゲージ │ 選択中はネイビーウィンドウがポップアップ         │
└───────────────┴──────────────────────────────┘
```
- 画面は基本的に固定レイアウト（スクロール無し）。
- コマンドウィンドウの選択でサブウィンドウがマップ上に開き、関連情報を表示。
- AIチャットはコマンドウィンドウの「チャット」選択時、NPC窓として表示。

## 4. UIウィジェット詳細
- **メインマップ**: PixiJSによる描画。背景タイル、道、オブジェクト、NPCをレイヤーで管理。アバターはドット絵スプライトで歩行アニメーションを再生。
- **ステータス枠**: 右下。アバター名、今日の完了タスク数、集中ゲージ（ポモドーロ残弾）を表示。RPGのステータスウィンドウを模した装飾。
- **コマンドウィンドウ**: 画面下部。タスク / ポモ / レコードの3コマンドを等間隔表示。選択中のコマンドはハイライトし、対応するサブウィンドウが中央下寄りに開く。
- **サブウィンドウ**:
  - タスク: 今日のタスク一覧、ステータスアイコン付き
  - ポモ: 現在のポモドーロタイマー、セッション履歴
  - レコード: 週間/連続完了日数などのメトリクス

## 5. ビジュアルスタイルガイド
- **カラーパレット**
  - `--dq-blue`: `#0d1424`（ウィンドウ背景）
  - `--dq-gold`: `#00d8ff`（枠線・アクセント）
  - `--dq-black`: `#05080f`（シャドウ・アウトライン）
  - `--dq-white`: `#e6faff`（テキスト）
  - `--dq-red`: `#ff4d80`（警告・強調）
- **フォント**
  - 見出し: ピクセル調（例: "Press Start 2P"）
  - 本文: 読みやすさ優先のサンセリフ（"Inter"など）
  - テキストは白文字に黒アウトライン（CSSで2px text-shadow）
- **ウィンドウ装飾**
  - ボーダー: `border-4` + `--dq-gold`
  - 背景: `bg-[var(--dq-blue)]`
  - 内側余白: `px-4 py-3`
  - コマンド選択時は `bg-[rgba(0,216,255,0.18)]` と発光ボーダーでネオン感を演出。
  - 右下にウィンドウ表示トグルを配置し、サブウィンドウ／バルーンの個別開閉を可能にする。

## 6. アセット要件
- **タイルセット**: 草原、砂道、水面、橋、城壁など 16px グリッドのPNG。
- **スプライト**:
  - アバター: 歩行全方位（前・後・左右）4フレームずつ（PNGシート）
  - NPC: 宿屋、ガイド、モンスター等 2フレームアニメ
  - オブジェクト: 宝箱（開閉）、旗、石碑、光エフェクト
- **アイコン**: タスク状態、ポモドーロ、記録、チャット用の16pxアイコン

## 7. アニメーションと演出
- アバター移動: 16px刻みで歩行アニメ（8fps程度）。
- タスク完了: 旗アイコンが点滅→光粒子が水平に散るピクシエフェクト→メッセージウィンドウ表示。
- コマンド選択: 0.2秒のフェードイン＋下から上へのスライド。
- サブウィンドウ閉じる際は逆アニメーション（上→下）。

## 8. 実装ガイドライン（UIレイヤー）
- Tailwindテーマ拡張で `dq-blue` などのCSS変数を定義。
- ウィンドウ類は shadcn/uiの `Dialog` / `Sheet` をベースに装飾変更。
- MapCanvasは CSR専用 `dynamic(() => import(...), { ssr: false })`。
- AIチャットは `チャット` コマンド選択時に表示、背景透過でNPCウィンドウライクに。
- グリッドレイアウトは `h-dvh` 固定、メインマップを `relative` とし、サブウィンドウは `absolute` で重ねる。

## 9. テキスト/コピー指針
- メニュー項目: `たたかう` の代替で `タスク`, `どうぐ`の代替で`ポモ`, `つよさ`の代替で`レコード`。
- メッセージウィンドウ: 2行ベースで折り返し、末尾に点滅するカーソル（CSSアニメ）を表示。
- ステータス名: アバター名は `勇者 <ユーザ名>` の形式で表記。（例: 勇者 かずと）

## 10. フラグとの連動
- `.env` の機能フラグ `_FEATURE_MAP_RPG` が `off` の場合は全UIをフォールバックし、`on` で本ビジュアルを適用。
- フラグ管理はレイアウトコンポーネントで共通化し、Dashboardタブだけ個別切替が可能な構成を想定。

## 11. 残課題 / 次ステップ
1. フォントライセンス確認と配信方式（self-host vs CDN）の決定
2. ピクセルアセット制作のスケジュール調整（内製 or 外注）
3. Figmaでのビジュアルモック作成（アニメーション指示を含む）
4. MapCanvasレンダリングとサブウィンドウの重ね合わせ動作をプロトタイプで検証

## 12. 実装反映メモ（2025-02-XX）
- `web/app/dashboard/page.tsx` 上段をタスク一覧＋ポモドーロHUD、下段をRPGマップモックという構成で統合。
- `web/components/DQMapMock.tsx` にソロハックカラーのマップ背景、ノード、コマンドウィンドウ、メッセージ表示、バルーンを実装。
- コマンド再クリックでサブウィンドウを折りたたみ／展開。右下のトグルでステータス／コマンド／メッセージ／バルーンを個別にON/OFF可能。
- `/dashboard/dq-preview` ルートはモック単体のプレビューとして維持し、ダッシュボード本体と同一コンポーネントを参照。

---

本書はドラゴンクエスト風ダッシュボードの見た目をイメージしやすくするための仮要件定義です。実装段階で追加要件や制約が判明した場合は改訂してください。
